<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í—Ö–æ–¥ –≤ Valorant</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--tg-theme-bg-color, #fff);
            color: var(--tg-theme-text-color, #000);
            padding: 20px;
            text-align: center;
        }
        .container { max-width: 400px; margin: 0 auto; }
        .btn {
            background-color: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, #fff);
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            display: block;
            margin: 10px 0;
            width: 100%;
            box-sizing: border-box;
        }
        .btn-red { background-color: #e91e63; }
        .alert {
            background: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 8px;
            font-size: 13px;
            margin-bottom: 15px;
            border: 1px solid #ffeeba;
            text-align: left;
        }
        textarea {
            width: 100%;
            height: 80px;
            border-radius: 12px;
            border: 2px solid var(--tg-theme-hint-color, #ccc);
            padding: 10px;
            box-sizing: border-box;
            resize: none;
            font-size: 12px;
            font-family: monospace;
        }
        .step {
            background: var(--tg-theme-secondary-bg-color, #f5f5f5);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>–í—Ö–æ–¥ (–†–µ–∂–∏–º Riot Client)</h2>
        
        <div class="step">
            <h3>–®–∞–≥ 1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h3>
            <div class="alert">
                ‚ö†Ô∏è <b>–í–ù–ò–ú–ê–ù–ò–ï:</b> –ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É "–ù–µ —É–¥–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–∞–π—Ç—É" (localhost). <br>
                <b>–≠–¢–û –ù–û–†–ú–ê–õ–¨–ù–û!</b> –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É –∏–∑ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –Ω–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å –æ—à–∏–±–∫–æ–π.
            </div>
            <!-- –°—Å—ã–ª–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è RIOT CLIENT -->
            <a href="https://auth.riotgames.com/authorize?redirect_uri=http%3A%2F%2Flocalhost%2Fredirect&client_id=riot-client&response_type=token%20id_token&nonce=1&scope=openid" target="_blank" class="btn btn-red">üöÄ –í–æ–π—Ç–∏ (Riot Client)</a>
        </div>

        <div class="step">
            <h3>–®–∞–≥ 2. –í—Å—Ç–∞–≤–∫–∞ —Å—Å—ã–ª–∫–∏</h3>
            <p>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞ <code>http://localhost/redirect...</code></p>
            <textarea id="urlInput" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –ø–æ–ª–Ω—É—é —Å—Å—ã–ª–∫—É —Å—é–¥–∞..."></textarea>
            <button id="sendBtn" class="btn" style="display: none;">‚úÖ –ü–æ–¥–∫–ª—é—á–∏—Ç—å</button>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const urlInput = document.getElementById('urlInput');
        const sendBtn = document.getElementById('sendBtn');

        urlInput.addEventListener('input', () => {
            const text = urlInput.value;
            if (text.includes('access_token=')) {
                sendBtn.style.display = 'block';
            } else {
                sendBtn.style.display = 'none';
            }
        });

        sendBtn.addEventListener('click', () => {
            let text = urlInput.value.trim(); // –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã
            
            try {
                // –ü—ã—Ç–∞–µ–º—Å—è –≤—ã—Ç–∞—â–∏—Ç—å —Ç–æ–∫–µ–Ω –¥–∞–∂–µ –∏–∑ –∫—Ä–∏–≤–æ–π —Å—Å—ã–ª–∫–∏
                let accessToken = "";
                
                if (text.includes("access_token=")) {
                    let start = text.indexOf("access_token=") + 13;
                    let end = text.indexOf("&", start);
                    if (end === -1) end = text.length;
                    accessToken = text.substring(start, end);
                }

                if (accessToken) {
                    tg.sendData(JSON.stringify({ access_token: accessToken }));
                } else {
                    tg.showAlert('–ù–µ –≤–∏–∂—É access_token –≤ —ç—Ç–æ–π —Å—Å—ã–ª–∫–µ!');
                }
            } catch (e) {
                tg.showAlert("–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞: " + e.message);
            }
        });
    </script>
</body>
</html>
